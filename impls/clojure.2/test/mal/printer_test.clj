(ns mal.printer-test
  (:require [clojure.test :refer [deftest is]]
            [mal.core :as core]
            [mal.printer :as p]))

(deftest printer-pr-str
  (is (= (p/pr-str 1 true) "1"))
  (is (= (p/pr-str "1" true) "\"1\""))
  (is (= (p/pr-str (core/symbol "a") true) "a"))
  (is (= (p/pr-str [1 "2" (core/symbol "x")] true) "[1 \"2\" x]"))
  (is (= (p/pr-str (list 1 ["2" (core/symbol "some-symbol")]) true)
         "(1 [\"2\" some-symbol])"))
  (is (= (p/pr-str "abc\"def" true) "\"abc\\\"def\""))
  (is (= (p/pr-str "a\nb" true) "\"a\\nb\""))
  (is (= (p/pr-str "a\tb" true) "\"a\\tb\""))
  (is (= (p/pr-str "a\\b" true) "\"a\\\\b\""))
  (is (= (p/pr-str {} true) "{}"))
  (is (= (p/pr-str {1 2 3 4} true) "{1 2 3 4}"))
  (is (= (p/pr-str (core/keyword "some.namespace/some-keyword") true)
         ":some.namespace/some-keyword"))
  (is (= (p/pr-str {(core/keyword "a") 1 (core/keyword "b") 2} true)
         "{:a 1 :b 2}"))
  (is (= (p/pr-str nil true) "nil"))
  (is (= (p/pr-str true true) "true"))
  (is (= (p/pr-str false true) "false"))
  (is (= (p/pr-str "abc\"def" false) "abc\"def"))
  (is (= (p/pr-str "a\nb" false) "a\nb"))
  (is (= (p/pr-str "a\tb" false) "a\tb"))
  (is (= (p/pr-str "a\\b" false) "a\\b"))
  (is (= (p/pr-str (list "a\"b" "c\nd" "e\\f" "g\th") false)
         "(a\"b c\nd e\\f g\th)"))
  (is (= (p/pr-str ["a\"b" "c\nd" "e\\f" "g\th"] false)
         "[a\"b c\nd e\\f g\th]"))
  (is (= (p/pr-str {"a\"b" "c\nd" "e\\f" "g\th"} false)
         "{a\"b c\nd e\\f g\th}")))
